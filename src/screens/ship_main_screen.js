// Generated by CoffeeScript 1.6.1
(function() {
  var PlayerShip;

  game.ShipMainScreen = cc.LayerColor.extend({
    _shipSprite: null,
    ctor: function() {
      var size;
      this._super(new cc.Color4B(0, 0, 0, 255));
      size = cc.Director.getInstance().getWinSize();
      this._shipSprite = new PlayerShip();
      this.setTouchEnabled(true);
      this.setKeyboardEnabled(true);
      this.setPosition(new cc.Point(0, 0));
      this.addChild(this._shipSprite);
      this._shipSprite.setPosition(new cc.Point(size.width / 2, size.height / 2));
      this._shipSprite.scheduleUpdate();
      this.schedule(this.update);
      return true;
    },
    onEnter: function() {
      return this._super();
    },
    update: function(dt) {},
    onTouchesEnded: function(pTouch, pEvent) {},
    onTouchesMoved: function(pTouch, pEvent) {
      return this._shipSprite.handleTouchMove(pTouch[0].getLocation());
    },
    onKeyUp: function(e) {},
    onKeyDown: function(e) {
      return this._shipSprite.handleKey(e);
    }
  });

  game.ShipMainScreenScene = cc.Scene.extend({
    onEnter: function() {
      this._super();
      return this.addChild(new game.ShipMainScreen());
    }
  });

  PlayerShip = cc.Sprite.extend({
    ROTATION_VECTOR: 10,
    _currentRotation: 0,
    ctor: function() {
      this._super();
      return this.initWithFile(s_Ship_Stationary);
    },
    update: function(dt) {
      return this.setRotation(this._currentRotation);
    },
    handleKey: function(e) {
      if (e === cc.KEY.left) {
        this._currentRotation = this._currentRotation - this.ROTATION_VECTOR;
      } else if (e === cc.KEY.right) {
        this._currentRotation = this._currentRotation + this.ROTATION_VECTOR;
      }
      if (this._currentRotation < 0) {
        this._currentRotation = 360;
      }
      if (this._currentRotation > 360) {
        return this._currentRotation = 0;
      }
    },
    handleTouchMove: function(touchLocation) {
      var angle;
      angle = Math.atan2(touchLocation.x - 300, touchLocation.y - 300);
      angle = angle * (180 / Math.PI);
      return this._currentRotation = angle;
    },
    myUpdate: function(dt) {
      return this._radians -= 6;
    }
  });

}).call(this);
